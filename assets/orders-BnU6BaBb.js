import{i as g,r as y,a3 as h,w as s,o as l,b as o,a6 as m,c,e as k,F as V,n as w,t as d}from"./index-DjxrM9kz.js";import{b as u}from"./route-block-B_A1xBdJ.js";import{V as S}from"./VContainer-BlsM2P_3.js";import{V as p}from"./VCol-CxPt3hGo.js";import{V as b}from"./VDivider-BcnLaL48.js";import{V as v}from"./VDataTable-BUVg1588.js";import{V as x}from"./VRow-mQ6G9vCQ.js";import"./VList-Buei6j9H.js";import"./ssrBoot-C0hcEdkP.js";import"./VMenu-CszNxHnm.js";import"./VChip-C42dMxPu.js";const I=m("h1",{class:"text-center"},"訂單管理",-1),A={__name:"orders",setup(B){const{apiAuth:f}=w(),_=g(),i=y([]),D=[{title:"編號",key:"_id"},{title:"帳號",key:"user.account"},{title:"訂購日期",key:"createdAt",value:a=>new Date(a.createdAt).toLocaleString()},{title:"訂房時間",key:"date",value:a=>a.cart.map(e=>{if(e.date||e.date.length>0){const t=new Date(e.date[0]).toISOString().split("T")[0];let r="";if(e.date.length===1)r=new Date(new Date(t).setDate(new Date(t).getDate()+1)).toISOString().split("T")[0];else if(e.date.length>1){const n=new Date(e.date[e.date.length-1]);n.setDate(n.getDate()),r=n.toISOString().split("T")[0]}return`${t}入住 至 ${r} 退房`}return"無日期"}).join(", ")},{title:"商品",key:"cart",sortable:!1},{title:"金額",key:"price",value:a=>a.cart.reduce((e,t)=>e+t.quantity*t.p_id.price,0)}];return(async()=>{var a,e;try{const{data:t}=await f.get("/order/all");i.value.push(...t.result)}catch(t){console.log(t),_({text:((e=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:e.message)||"發生錯誤",snackbarProps:{color:"red"}})}})(),(a,e)=>(l(),h(S,null,{default:s(()=>[o(x,null,{default:s(()=>[o(p,{cols:"12"},{default:s(()=>[I]),_:1}),o(b),o(p,{cols:"12"},{default:s(()=>[o(v,{items:i.value,headers:D},{"item.cart":s(t=>[m("ul",null,[(l(!0),c(V,null,k(t.item.cart,r=>(l(),c("li",{key:r._id},d(r.p_id.name)+" * "+d(r.quantity),1))),128))])]),_:2},1032,["items"])]),_:1})]),_:1})]),_:1}))}};typeof u=="function"&&u(A);export{A as default};
