import{v as g,aF as H,x as D,b as n,p as b,P as M,L as P,l as C,$ as N,am as G,aG as Y,_ as J,i as K,r as B,a3 as Q,w as x,o as X,d as Z,ak as p,h as ee,t as ae,n as te}from"./index-Ciq8JlP7.js";import{b as W}from"./route-block-B_A1xBdJ.js";import{V as ne}from"./VRow-CG1IuCz2.js";import{V as F,m as le,u as ie}from"./calendar-BFE6Ybre.js";import{V as de}from"./VCol-DsUA74u1.js";import{V as re}from"./VBadge-DIbC7lur.js";import{V as ve}from"./VChip-BAd-88BM.js";const se=b({allDay:Boolean,interval:Object,intervalDivisions:{type:Number,required:!0},intervalDuration:{type:Number,required:!0},intervalHeight:{type:Number,required:!0},event:Object},"VCalendarIntervalEvent"),T=g()({name:"VCalendarIntervalEvent",props:se(),setup(e){const u=H(),i=()=>{var t,a,r,l;if(!((t=e.event)!=null&&t.first)&&!((a=e.event)!=null&&a.last)||u.isEqual((r=e.event)==null?void 0:r.start,(l=e.interval)==null?void 0:l.start))return{height:"100%",margin:M(0)};{const{height:c,margin:v}=Array.from({length:e.intervalDivisions},d=>d*(e.intervalDuration/e.intervalDivisions)).reduce((d,s,o)=>{var m,h;return u.isBefore(u.addMinutes((m=e.interval)==null?void 0:m.start,s),(h=e.event)==null?void 0:h.start)?{height:M(e.intervalHeight/e.intervalDivisions*o),margin:M(e.intervalHeight/e.intervalDivisions*o)}:{height:d.height,margin:d.margin}},{height:"",margin:""});return{height:c,margin:v}}};return D(()=>{var t,a,r,l,c;return n(F,{height:i().height,density:"comfortable",style:`margin-top: ${i().margin}`,class:"v-calendar-internal-event",color:((t=e.event)==null?void 0:t.color)??void 0,rounded:(a=e.event)!=null&&a.first&&((r=e.event)!=null&&r.last)?!0:(l=e.event)!=null&&l.first?"t":(c=e.event)!=null&&c.last?"b":!1},{default:()=>{var v,d;return[(v=e.event)!=null&&v.first?(d=e.event)==null?void 0:d.title:""]}})}),{}}}),j=b({day:{type:Object,default:()=>({})},dayIndex:Number,events:Array,intervalDivisions:{type:Number,default:2},intervalDuration:{type:Number,default:60},intervalHeight:{type:Number,default:48},intervalFormat:{type:[String,Function],default:"fullTime12h"},intervalStart:{type:Number,default:0}},"VCalendarInterval"),q=g()({name:"VCalendarInterval",props:{index:{type:Number,required:!0},...j()},setup(e,u){const i=H(),t=P(()=>{const a=i.addMinutes(i.startOfDay(e.day.date),e.intervalDuration*(e.index+e.intervalStart)),r=i.addMinutes(i.startOfDay(e.day.date),e.intervalDuration*(e.index+e.intervalStart+1)-1);return{...e.day,label:i.format(a,"fullTime24h"),start:a,end:r,events:e.events?e.events.filter(l=>!l.allDay&&(i.isEqual(a,l.start)||i.isWithinRange(l.start,[a,r])||i.isWithinRange(a,[l.start,l.end])||i.isEqual(r,l.end))).map(l=>({...l,first:i.isEqual(a,l.start)||i.isWithinRange(l.start,[a,r]),last:i.isEqual(r,l.end)||i.isWithinRange(l.end,[a,r])})):[]}});return D(()=>{var a,r;return e.dayIndex===0?n("div",{class:"v-calendar-day__row-with-label",style:`height: ${M(e.intervalHeight)}`},[n("div",{class:"v-calendar-day__row-label"},[n("slot",{name:"intervalFormat",interval:t.value},[e.index?e.intervalFormat?typeof e.intervalFormat=="string"?i.format(t.value.start,"hours12h"):e.intervalFormat(t.value):t.value.label:""])]),n("div",{class:"v-calendar-day__row-hairline"},null),n("div",{class:["v-calendar-day__row-content",t.value.events.some(l=>!l.last)?"v-calendar-day__row-content-through":""]},[n("slot",{name:"intervalBody",interval:t.value},[(a=t.value.events)==null?void 0:a.map(l=>n(T,{event:l,interval:t.value,intervalDivisions:e.intervalDivisions,intervalDuration:e.intervalDuration,intervalHeight:e.intervalHeight},null))])])]):n("div",{class:"v-calendar-day__row-without-label",style:`height: ${M(e.intervalHeight)}`},[n("div",{class:["v-calendar-day__row-content",t.value.events.some(l=>!l.last)?"v-calendar-day__row-content-through":""]},[n("slot",{name:"intervalBody",interval:t.value},[(r=t.value.events)==null?void 0:r.filter(l=>!l.allDay).map(l=>n(T,{event:l,interval:t.value,intervalDivisions:e.intervalDivisions,intervalDuration:e.intervalDuration,intervalHeight:e.intervalHeight},null))])])])}),{interval:t}}}),R=b({hideDayHeader:Boolean,intervals:{type:Number,default:24},...j()},"VCalendarDay"),I=g()({name:"VCalendarDay",props:R(),setup(e){const u=H(),i=P(()=>[...Array.from({length:e.intervals},(t,a)=>a).filter((t,a)=>e.intervalDuration*(a+e.intervalStart)<1440)]);return D(()=>{const t=q.filterProps(e);return n("div",{class:"v-calendar-day__container"},[!e.hideDayHeader&&n("div",{key:"calender-week-name",class:"v-calendar-weekly__head-weekday"},[u.format(e.day.date,"weekdayShort"),n("div",null,[n(C,{icon:!0,text:u.format(e.day.date,"dayOfMonth"),variant:"text"},null)])]),i.value.map((a,r)=>n(q,N({index:r},t),null))])}),{intervals:i}}}),z=b({nextIcon:{type:String,default:"$next"},prevIcon:{type:String,default:"$prev"},title:String,text:{type:String,default:"$vuetify.calendar.today"},viewMode:{type:String,default:"month"}},"VCalendarHeader"),O=g()({name:"VCalendarHeader",props:z(),emits:{"click:next":()=>!0,"click:prev":()=>!0,"click:toToday":()=>!0},setup(e,u){let{emit:i}=u;const{t}=G();function a(){i("click:prev")}function r(){i("click:next")}function l(){i("click:toToday")}return D(()=>n("div",{class:"v-calendar-header"},[e.text&&n(C,{key:"today",class:"v-calendar-header__today",text:t(e.text),variant:"outlined",onClick:l},null),n(C,{density:"comfortable",icon:e.prevIcon,variant:"text",onClick:a},null),n(C,{density:"comfortable",icon:e.nextIcon,variant:"text",onClick:r},null),n("div",{class:"v-calendar-header__title"},[e.title])])),{}}}),ue=b({allDay:Boolean,day:Object,event:Object},"VCalendarEvent"),A=g()({name:"VCalendarEvent",props:ue(),setup(e){return D(()=>n(ve,{color:e.allDay?"primary":void 0,density:"comfortable",label:e.allDay,width:"100%"},{default:()=>{var u,i;return[n(re,{inline:!0,dot:!0,color:(u=e.event)==null?void 0:u.color},null),(i=e.event)==null?void 0:i.title]}})),{}}}),ce=b({active:Boolean,color:String,day:Object,disabled:Boolean,events:Array,title:[Number,String]},"VCalendarMonthDay"),oe=g()({name:"VCalendarMonthDay",props:ce(),setup(e,u){let{emit:i,slots:t}=u;return D(()=>{var r,l,c,v,d,s,o,m,h,_,w;const a=!!(e.title||(r=t.title)!=null&&r.call(t,{title:e.title}));return n("div",{class:["v-calendar-month__day"]},[!((l=e.day)!=null&&l.isHidden)&&a&&n("div",{key:"title",class:"v-calendar-weekly__day-label"},[((c=t.title)==null?void 0:c.call(t,{title:e.title}))??n(C,{class:(v=e.day)!=null&&v.isToday?"v-calendar-weekly__day-label__today":void 0,color:e.color,disabled:e.disabled,icon:!0,size:"x-small",variant:(d=e.day)!=null&&d.isToday?void 0:"flat"},{default:()=>[e.title]})]),!((s=e.day)!=null&&s.isHidden)&&n("div",{key:"content",class:"v-calendar-weekly__day-content"},[((o=t.content)==null?void 0:o.call(t))??n("div",null,[n("div",{class:"v-calendar-weekly__day-alldayevents-container"},[(m=e.events)==null?void 0:m.filter(y=>y.allDay).map(y=>t.event?t.event({day:e.day,allDay:!0,event:y}):n(A,{day:e.day,event:y,allDay:!0},null))]),n("div",{class:"v-calendar-weekly__day-events-container"},[(h=e.events)==null?void 0:h.filter(y=>!y.allDay).map(y=>t.event?t.event({day:e.day,event:y,allDay:!1}):n(A,{day:e.day,event:y},null))])])]),!((_=e.day)!=null&&_.isHidden)&&((w=t.default)==null?void 0:w.call(t))])}),{}}}),ye=b({hideHeader:Boolean,hideWeekNumber:Boolean,...le(),...R(),...z()},"VCalender"),me=g()({name:"VCalendar",props:ye(),emits:{next:null,prev:null,"update:modelValue":null},setup(e,u){let{emit:i,slots:t}=u;const a=H(),{daysInMonth:r,daysInWeek:l,genDays:c,model:v,displayValue:d,weekNumbers:s}=ie(e),o=a.getWeekdays();function m(){e.viewMode==="month"&&(v.value=[a.addMonths(d.value,1)]),e.viewMode==="week"&&(v.value=[a.addDays(d.value,7)]),e.viewMode==="day"&&(v.value=[a.addDays(d.value,1)])}function h(){e.viewMode==="month"&&(v.value=[a.addMonths(d.value,-1)]),e.viewMode==="week"&&(v.value=[a.addDays(d.value,-7)]),e.viewMode==="day"&&(v.value=[a.addDays(d.value,-1)])}function _(){v.value=[a.date()]}const w=P(()=>a.format(d.value,"monthAndYear"));return D(()=>{var $;const y=I.filterProps(e),U=O.filterProps(e);return n("div",{class:["v-calendar",{"v-calendar-monthly":e.viewMode==="month","v-calendar-weekly":e.viewMode==="week","v-calendar-day":e.viewMode==="day"}]},[n("div",null,[!e.hideHeader&&(t.header?t.header({title:w.value}):n(O,N({key:"calendar-header"},U,{title:w.value,"onClick:next":m,"onClick:prev":h,"onClick:toToday":_}),null))]),n("div",{class:["v-calendar__container",`days__${e.weekdays.length}`]},[e.viewMode==="month"&&!e.hideDayHeader&&n("div",{class:["v-calendar-weekly__head",`days__${e.weekdays.length}`,...e.hideWeekNumber?[]:["v-calendar-weekly__head-weeknumbers"]],key:"calenderWeeklyHead"},[e.hideWeekNumber?"":n("div",{key:"weekNumber0",class:"v-calendar-weekly__head-weeknumber"},null),e.weekdays.map(f=>n("div",{class:`v-calendar-weekly__head-weekday${e.hideWeekNumber?"":"-with-weeknumber"}`},[o[f]]))]),e.viewMode==="month"&&n("div",{key:"VCalendarMonth",class:["v-calendar-month__days",`days${e.hideWeekNumber?"":"-with-weeknumbers"}__${e.weekdays.length}`,...e.hideWeekNumber?[]:["v-calendar-month__weeknumbers"]]},[Y(r.value,e.weekdays.length).map((f,S)=>[e.hideWeekNumber?"":n("div",{class:"v-calendar-month__weeknumber"},[s.value[S]]),f.map(k=>{var V;return n(oe,{color:a.isSameDay(a.date(),k.date)?"primary":void 0,day:k,title:k?a.format(k.date,"dayOfMonth"):"NaN",events:(V=e.events)==null?void 0:V.filter(E=>a.isSameDay(k.date,E.start)||a.isSameDay(k.date,E.end))},{event:t.event})})])]),e.viewMode==="week"&&l.value.map((f,S)=>{var k;return n(I,N(y,{day:f,dayIndex:S,events:(k=e.events)==null?void 0:k.filter(V=>a.isSameDay(V.start,f.date)||a.isSameDay(V.end,f.date))}),null)}),e.viewMode==="day"&&n(I,N(y,{day:c([d.value],a.date())[0],dayIndex:0,events:($=e.events)==null?void 0:$.filter(f=>a.isSameDay(f.start,c([d.value],a.date())[0].date)||a.isSameDay(f.end,c([d.value],a.date())[0].date))}),null)])])}),{daysInMonth:r,daysInWeek:l,genDays:c}}}),L={__name:"calendar",setup(e){const{apiAuth:u}=te(),i=K(),t=B([]),a=B({}),r=v=>{const d=v.title,s=a.value[d];alert(s?`訂購人 : ${s.title}
房間名稱: ${s.info} 
 房間數量:${s.quantity}`:"沒有訂單")},l=async()=>{var v,d;try{const{data:s}=await u.get("/order/all");t.value=[],a.value={},s.result.forEach(o=>{o.cart.forEach(m=>{m.date.forEach(h=>{const _=o.user.account,w={title:_,start:new Date(h),end:new Date(new Date(h).getTime()+60*60*1e3)};t.value.push(w),a.value[_]={title:o.user.account,info:m.p_id.name,quantity:m.quantity}})})}),console.log("Updated events:",t.value)}catch(s){console.log(s),i({text:((d=(v=s==null?void 0:s.response)==null?void 0:v.data)==null?void 0:d.message)||"发生错误",snackbarProps:{color:"red"}})}},c=v=>`event-button ${{user1:"aaaa",user2:"bbbb"}[v]||"default-style"}`;return l(),(v,d)=>(X(),Q(ne,null,{default:x(()=>[n(de,null,{default:x(()=>[n(F,null,{default:x(()=>[n(Z(me),{color:"primary",events:t.value,headers:v.headers},{event:x(s=>[n(C,{class:p(["event-button",c(s.event.title)]),onClick:o=>r(s.event),style:{"min-width":"100px","text-align":"left"}},{default:x(()=>[ee(ae(s.event.title),1)]),_:2},1032,["class","onClick"])]),_:1},8,["events","headers"])]),_:1})]),_:1})]),_:1}))}};typeof W=="function"&&W(L);const be=J(L,[["__scopeId","data-v-278b7776"]]);export{be as default};
