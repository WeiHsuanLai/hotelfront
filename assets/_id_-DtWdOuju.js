import{i as x,u as S,r as q,c as F,b as a,w as r,by as k,F as w,bU as B,aZ as C,o as N,ai as u,t as n,N as M,d as l,f as U,aY as $,l as v,h as f,n as E}from"./index-Dul5dqrC.js";import{u as P,a as R}from"./vee-validate.esm-6hEoOcx2.js";import{c as T,b as j}from"./index.esm-CM_mT7FP.js";import{V as A}from"./VContainer-CEPO03jh.js";import{V as c}from"./VCol-ByzQSib6.js";import{V as D}from"./VForm-BvIpyFKb.js";const I={class:"text-center"},L=u("h1",{class:"text-center text-red"},"已下架",-1),Q={__name:"[id]",setup(O){const{api:g}=E(),_=B(),y=C(),d=x(),m=S(),e=q({_id:"",name:"",price:0,description:"",image:"",sell:!0,category:""});(async()=>{var o,s;try{const{data:t}=await g.get("/product/"+_.params.id);e.value._id=t.result._id,e.value.name=t.result.name,e.value.price=t.result.price,e.value.description=t.result.description,e.value.image=t.result.image,e.value.sell=t.result.sell,e.value.category=t.result.category,document.title="購物網 | "+e.value.name}catch(t){console.log(t),d({text:((s=(o=t==null?void 0:t.response)==null?void 0:o.data)==null?void 0:s.message)||"發生錯誤",snackbarProps:{color:"red"}})}})();const b=T({quantity:j().typeError("數量必填").required("數量必填").min(1,"最少為 1")}),{isSubmitting:p,handleSubmit:V}=P({validationSchema:b,initialValues:{quantity:1}}),i=R("quantity"),h=V(async o=>{if(!m.isLogin){y.push("/login");return}const s=await m.addCart(e.value._id,o.quantity);d({text:s.text,snackbarProps:{color:s.color}})});return(o,s)=>(N(),F(w,null,[a(A,null,{default:r(()=>[a(c,{cols:"12"},{default:r(()=>[u("h1",I,n(e.value.name),1)]),_:1}),a(c,{cols:"12"},{default:r(()=>[a(M,{src:e.value.image,height:"200"},null,8,["src"])]),_:1}),a(c,{cols:"12"},{default:r(()=>[u("p",null,"$"+n(e.value.price),1),u("p",null,n(e.value.description),1),a(D,{disabled:l(p),onSubmit:U(l(h),["prevent"])},{default:r(()=>[a($,{type:"number",modelValue:l(i).value.value,"onUpdate:modelValue":s[0]||(s[0]=t=>l(i).value.value=t),modelModifiers:{number:!0},"error-messages":l(i).errorMessage.value},null,8,["modelValue","error-messages"]),a(v,{type:"submit","prepend-icon":"mdi-cart",loading:l(p)},{default:r(()=>[f("加入購物車")]),_:1},8,["loading"])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1}),a(k,{class:"align-center justify-center text-center","model-value":!e.value.sell,persistent:""},{default:r(()=>[L,a(v,{to:"/"},{default:r(()=>[f("回首頁")]),_:1})]),_:1},8,["model-value"])],64))}};export{Q as default};
